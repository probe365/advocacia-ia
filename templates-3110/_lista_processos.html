<div class="d-flex justify-content-end mb-2 mt-2">
  <a href="/processos/{{ id_cliente }}/novo" class="btn btn-success btn-sm">+ Adicionar Processo</a>
</div>

<input type="text" class="form-control form-control-sm mb-2" placeholder="Filtrar por nome, c√≥digo, ou papel (ex: autor, reu)" oninput="filtrarProcessos(this.value)">
<div class="btn-group mb-2 ms-2" role="group">
  <input type="radio" class="btn-check" name="filter-tipo-parte" id="filter-all" value="" checked onchange="filtrarProcessos(document.querySelector('input[name=\'filter-tipo-parte\']:checked').value)">
  <label class="btn btn-outline-secondary btn-sm" for="filter-all">Todos</label>
  
  <input type="radio" class="btn-check" name="filter-tipo-parte" id="filter-autor" value="autor" onchange="filtrarProcessos(document.querySelector('input[name=\'filter-tipo-parte\']:checked').value)">
  <label class="btn btn-outline-secondary btn-sm" for="filter-autor">üë§ Autor</label>
  
  <input type="radio" class="btn-check" name="filter-tipo-parte" id="filter-reu" value="reu" onchange="filtrarProcessos(document.querySelector('input[name=\'filter-tipo-parte\']:checked').value)">
  <label class="btn btn-outline-secondary btn-sm" for="filter-reu">üõ°Ô∏è R√©u</label>
  
  <input type="radio" class="btn-check" name="filter-tipo-parte" id="filter-terceiro" value="terceiro" onchange="filtrarProcessos(document.querySelector('input[name=\'filter-tipo-parte\']:checked').value)">
  <label class="btn btn-outline-secondary btn-sm" for="filter-terceiro">üë• Terceiro</label>
  
  <input type="radio" class="btn-check" name="filter-tipo-parte" id="filter-labor" value="labor" onchange="filtrarProcessos(document.querySelector('input[name=\'filter-tipo-parte\']:checked').value)">
  <label class="btn btn-outline-secondary btn-sm" for="filter-labor">üíº Trabalhista</label>
</div>

<div class="list-group" id="lista-processos-grupo">
  
  {% for processo in processos %}
  <a href="/processos/painel/{{ processo.id_processo }}" class="list-group-item list-group-item-action" data-tipo-parte="{{ processo.tipo_parte or '' }}" data-search-text="{{ processo.nome_caso }} {{ processo.case_code }} {{ processo.tipo_parte or '' }}">
      <div class="d-flex w-100 justify-content-between align-items-start">
        <div>
          <h6 class="mb-1">
            {{ processo.nome_caso }} 
            <small class="text-muted">({{ processo.case_code or '...' }})</small>
            {% if processo.tipo_parte %}
              <span class="badge bg-info text-dark ms-2">{{ processo.tipo_parte }}</span>
            {% else %}
              <span class="badge bg-secondary text-white ms-2">sem papel</span>
            {% endif %}
          </h6>
          <p class="mb-1 small">
            <small>N¬∫: {{ processo.numero_cnj or 'N√£o informado' }}</small>
          </p>
        </div>
        <small class="text-muted">Status: {{ processo.status }}</small>
      </div>
    </a>
  {% else %}
    <div class="list-group-item">
      <p class="mb-1 text-muted">Nenhum processo cadastrado para este cliente.</p>
    </div>
  {% endfor %}

</div>
<script>
function filtrarProcessos(q){
  const filterType = q.toLowerCase().trim();
  const items = document.querySelectorAll('#lista-processos-grupo a.list-group-item');
  
  items.forEach(it=>{
    let show = true;
    
    if(filterType === 'labor') {
      // Filter for labor cases (reclamante or reclamada)
      const tipoParte = it.getAttribute('data-tipo-parte') || '';
      show = tipoParte === 'reclamante' || tipoParte === 'reclamada';
    } else if(filterType) {
      // Filter by tipo_parte value or search text
      const tipoParte = it.getAttribute('data-tipo-parte') || '';
      const searchText = it.getAttribute('data-search-text') || '';
      show = tipoParte === filterType || searchText.toLowerCase().indexOf(filterType) !== -1;
    }
    
    it.style.display = show ? '' : 'none';
  });
}
</script>