{# Display chat messages in reverse chronological order (newest first) #}
{% if chat_history %}
  {% for message in chat_history|reverse %}
    {% if message.role == 'user' %}
      <div class="d-flex flex-row justify-content-end p-2">
        <div class="bg-primary text-white p-2 rounded" style="max-width: 80%;">
          {{ message.content }}
        </div>
      </div>
    {% else %}
      <div class="d-flex flex-row justify-content-start p-2">
        <div class="bg-light text-dark p-2 rounded" style="max-width: 80%;">
          {{ message.content | safe }}
        </div>
      </div>
    {% endif %}
  {% endfor %}
{% else %}
  <div class="text-muted text-center p-4">
    <small>Nenhuma mensagem ainda. Fa√ßa uma pergunta sobre o caso.</small>
  </div>
{% endif %}

<script>
  // Auto-scroll to bottom of chat after content loads
  (function() {
    const container = document.getElementById('chat-container');
    if (container) {
      container.scrollTop = container.scrollHeight;
    }
  })();
</script>